{% extends 'base.html' %}
{% block content %}
<div class="flex">
  <div class="w-2/3 pr-8">
    <h2 class="text-2xl font-bold mb-4">Liste des tirages</h2>
    
    <div class="grid grid-cols-3 gap-4">
      {% for draw in draws %}
      <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="font-bold">{{ draw.name }}</h3>
        <p>{{ draw.draw_date|date:"d F Y" }}</p>
        <button onclick="submitTicket({{ draw.id }})" class="bg-blue-500 text-white px-4 py-2 rounded mt-2">
          Voir les gagnants
        </button>
      </div>
      {% endfor %}
    </div>


   
    </div>
  </div>
</div>
  <script>
    let selectedNumbers = [];
    let selectedBonus = [];
    function submitTicket(drawId) {
      fetch(window.location.href, {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
              'X-CSRFToken': '{{ csrf_token }}'
          },
          body: JSON.stringify({
              selected_numbers: selectedNumbers,
              selected_bonus: selectedBonus,
              draw_id: drawId
          })
      })
      .then(response => response.json())
      .then(data => {
          alert(data.message);
          // Réinitialiser les sélections
          selectedNumbers = [];
          selectedBonus = [];
      });
  }
  </script>
  {% endblock %}
</div>
